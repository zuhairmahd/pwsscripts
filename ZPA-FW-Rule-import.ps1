$IPAddresses = @('136.226.26.0/23', '136.226.28.0/23', '136.226.32.0/23', '136.226.34.0/23', '136.226.38.0/23', '136.226.40.0/23', '136.226.42.0/24', '15.200.104.243/32', '15.200.124.156/32', '15.200.127.126/32', '15.200.127.164/32', '15.200.135.32/32', '15.200.139.68/32', '15.200.140.68/32', '15.200.144.171/32', '15.200.144.216/32', '15.200.144.22/32', '15.200.148.139/32', '15.200.155.46/32', '15.200.162.232/32', '15.200.164.207/32', '15.200.165.88/32', '15.200.168.17/32', '15.200.168.180/32', '15.200.17.232/32', '15.200.171.129/32', '15.200.171.79/32', '15.200.23.64/32', '15.200.25.54/32', '15.200.27.53/32', '15.200.34.17/32', '15.200.4.71/32', '15.200.40.238/32', '15.200.40.248/32', '15.200.49.164/32', '15.200.51.244/32', '15.200.59.117/32', '15.200.64.5/32', '15.200.64.93/32', '15.200.69.25/32', '15.200.70.53/32', '15.200.72.165/32', '15.200.74.254/32', '15.200.76.225/32', '15.200.86.139/32', '15.200.90.171/32', '160.1.0.23/32', '160.1.108.214/32', '160.1.163.5/32', '160.1.164.70/32', '160.1.174.59/32', '160.1.176.178/32', '160.1.177.77/32', '160.1.65.151/32', '160.1.73.220/32', '160.1.75.186/32', '160.1.80.253/32', '160.1.92.248/32', '160.1.95.32/32', '170.85.48.0/24', '170.85.49.0/24', '18.252.0.119/32', '18.252.0.216/32', '18.252.100.162/32', '18.252.100.176/32', '18.252.100.29/32', '18.252.105.143/32', '18.252.105.150/32', '18.252.105.161/32', '18.252.106.129/32', '18.252.106.244/32', '18.252.106.248/32', '18.252.12.15/32', '18.252.12.59/32', '18.252.16.101/32', '18.252.17.168/32', '18.252.17.207/32', '18.252.17.22/32', '18.252.17.231/32', '18.252.17.244/32', '18.252.2.151/32', '18.252.20.131/32', '18.252.21.233/32', '18.252.22.56/32', '18.252.23.157/32', '18.252.24.147/32', '18.252.26.148/32', '18.252.3.160/32', '18.252.5.255/32', '18.252.55.121/32', '18.252.60.165/32', '18.252.61.109/32', '18.252.61.167/32', '18.252.61.247/32', '18.252.61.57/32', '18.252.62.94/32', '18.252.63.209/32', '18.252.63.38/32', '18.252.63.57/32', '18.252.64.118/32', '18.252.64.157/32', '18.252.64.224/32', '18.252.64.97/32', '18.252.65.120/32', '18.252.65.175/32', '18.252.65.200/32', '18.252.65.52/32', '18.252.65.59/32', '18.252.66.139/32', '18.252.66.155/32', '18.252.67.149/32', '18.252.68.181/32', '18.252.69.152/32', '18.252.69.94/32', '18.252.80.108/32', '18.252.80.252/32', '18.252.80.86/32', '18.252.81.181/32', '18.252.83.204/32', '18.252.83.235/32', '18.252.85.161/32', '18.252.85.179/32', '18.252.85.194/32', '18.252.85.195/32', '18.252.85.95/32', '18.252.86.0/32', '18.252.86.134/32', '18.252.87.63/32', '18.252.88.159/32', '18.252.88.169/32', '18.252.88.238/32', '18.252.89.132/32', '18.252.89.175/32', '18.252.89.20/32', '18.252.89.208/32', '18.252.89.76/32', '18.252.9.129/32', '18.252.9.5/32', '18.252.90.105/32', '18.252.95.116/32', '18.252.95.170/32', '18.252.96.184/32', '18.252.96.55/32', '18.252.97.142/32', '18.252.97.165/32', '18.252.97.216/32', '18.252.98.162/32', '18.252.98.181/32', '18.252.98.222/32', '18.252.98.34/32', '18.252.99.148/32', '18.252.99.172/32', '18.252.99.44/32', '18.252.99.73/32', '18.253.105.44/32', '18.253.107.39/32', '18.253.108.158/32', '18.253.109.15/32', '18.253.110.23/32', '18.253.111.17/32', '18.253.113.178/32', '18.253.114.15/32', '18.253.114.73/32', '18.253.116.103/32', '18.253.118.2/32', '18.253.120.112/32', '18.253.122.182/32', '18.253.125.90/32', '18.253.126.246/32', '18.253.126.77/32', '18.253.126.91/32', '18.253.127.0/32', '18.253.151.44/32', '18.253.155.69/32', '18.253.156.123/32', '18.253.162.84/32', '18.253.163.101/32', '18.253.165.13/32', '18.253.165.212/32', '18.253.178.238/32', '18.253.179.50/32', '18.253.180.12/32', '18.253.182.185/32', '18.253.182.46/32', '18.253.184.141/32', '18.253.184.149/32', '18.253.185.24/32', '18.253.185.90/32', '18.253.188.29/32', '18.253.190.193/32', '18.253.190.247/32', '18.253.190.77/32', '18.253.193.56/32', '18.253.194.243/32', '18.253.195.111/32', '18.253.195.98/32', '18.253.198.229/32', '18.253.198.50/32', '18.253.198.56/32', '18.253.202.174/32', '18.253.205.228/32', '18.253.206.28/32', '18.253.207.138/32', '18.253.207.144/32', '18.253.209.182/32', '18.253.209.61/32', '18.253.223.81/32', '18.253.223.94/32', '18.253.224.0/32', '18.253.224.34/32', '18.253.226.119/32', '18.253.226.187/32', '18.253.226.53/32', '18.253.227.132/32', '18.253.227.147/32', '18.253.228.123/32', '18.253.228.201/32', '18.253.229.82/32', '18.253.230.105/32', '18.253.230.199/32', '18.253.230.8/32', '18.253.232.158/32', '18.253.233.212/32', '18.253.234.102/32', '18.253.234.248/32', '18.253.33.72/32', '18.253.34.73/32', '18.253.37.237/32', '18.253.39.95/32', '18.253.42.250/32', '18.253.44.112/32', '18.253.44.229/32', '18.253.45.114/32', '18.253.45.139/32', '18.253.46.84/32', '18.253.48.122/32', '18.253.51.158/32', '18.253.51.212/32', '18.253.53.185/32', '18.253.54.191/32', '18.253.55.159/32', '18.253.56.228/32', '18.253.69.82/32', '18.253.70.106/32', '18.253.71.139/32', '18.253.71.92/32', '18.253.72.66/32', '18.253.74.155/32', '18.253.75.226/32', '18.253.77.146/32', '18.253.79.54/32', '18.253.80.159/32', '18.253.83.233/32', '18.253.86.202/32', '18.253.88.55/32', '18.253.89.114/32', '18.253.89.156/32', '18.253.89.84/32', '18.253.90.245/32', '18.253.92.124/32', '18.253.92.176/32', '18.253.92.226/32', '18.253.94.84/32', '18.253.96.174/32', '18.253.97.208/32', '3.32.1.97/32', '3.32.10.127/32', '3.32.10.209/32', '3.32.100.212/32', '3.32.101.228/32', '3.32.101.70/32', '3.32.102.83/32', '3.32.103.201/32', '3.32.103.221/32', '3.32.103.232/32', '3.32.103.62/32', '3.32.2.214/32', '3.32.35.94/32', '3.32.36.203/32', '3.32.37.149/32', '3.32.38.49/32', '3.32.40.45/32', '3.32.40.87/32', '3.32.45.118/32', '3.32.45.178/32', '3.32.48.80/32', '3.32.51.197/32', '3.32.51.213/32', '3.32.52.152/32', '3.32.52.227/32', '3.32.53.24/32', '3.32.54.213/32', '3.32.54.239/32', '3.32.59.181/32', '3.32.61.105/32', '3.32.69.122/32', '3.32.7.144/32', '3.32.71.118/32', '3.32.71.180/32', '3.32.72.97/32', '3.32.73.197/32', '3.32.75.71/32', '3.32.75.85/32', '3.32.82.84/32', '3.32.83.147/32', '3.32.83.219/32', '3.32.84.129/32', '3.32.84.59/32', '3.32.85.155/32', '3.32.85.2/32', '3.32.86.127/32', '3.32.87.193/32', '3.32.87.38/32', '3.32.88.114/32', '3.32.88.229/32', '3.32.89.82/32', '3.32.90.121/32', '3.32.90.46/32', '3.32.92.3/32', '3.32.96.219/32', '3.32.97.84/32', '3.32.97.92/32', '3.32.98.115/32', '3.32.98.182/32', '3.32.99.191/32', '52.222.107.152/32', '52.222.121.104/32', '52.222.122.94/32', '52.222.19.122/32', '52.222.21.68/32', '52.222.23.48/32', '52.222.30.160/32', '52.222.49.238/32', '52.222.51.215/32', '52.222.53.159/32', '52.222.54.138/32', '52.222.59.9/32', '52.222.70.13/32', '52.222.73.3/32', '52.222.73.9/32', '52.222.74.194/32', '52.222.76.229/32', '52.222.88.78/32', '52.222.89.176/32', '52.222.91.152/32', '52.222.93.27/32', '52.222.96.14/32', '52.61.100.48/32', '52.61.101.28/32', '52.61.105.171/32', '52.61.111.136/32', '52.61.111.161/32', '52.61.114.33/32', '52.61.136.123/32', '52.61.141.234/32', '52.61.142.92/32', '52.61.149.228/32', '52.61.153.143/32', '52.61.154.170/32', '52.61.159.12/32', '52.61.160.202/32', '52.61.162.28/32', '52.61.165.175/32', '52.61.173.84/32', '52.61.179.5/32', '52.61.182.220/32', '52.61.187.219/32', '52.61.195.110/32', '52.61.21.142/32', '52.61.210.236/32', '52.61.215.102/32', '52.61.218.133/32', '52.61.222.19/32', '52.61.223.134/32', '52.61.23.221/32', '52.61.232.162/32', '52.61.31.90/32', '52.61.32.153/32', '52.61.33.49/32', '52.61.38.89/32', '52.61.41.195/32', '52.61.47.21/32', '52.61.5.228/32', '52.61.56.99/32', '52.61.58.122/32', '52.61.59.65/32', '52.61.65.187/32', '52.61.66.244/32', '52.61.67.172/32', '52.61.67.225/32', '52.61.74.112/32', '52.61.74.90/32', '52.61.76.73/32', '52.61.8.195/32', '52.61.87.220/32', '52.61.91.25/32', '52.61.94.74/32', '96.127.33.241/32', '96.127.36.77/32', '96.127.38.128/32', '96.127.45.192/32', '96.127.45.235/32', '96.127.47.244/32', '96.127.52.38/32', '96.127.56.211/32', '96.127.62.164/32', '96.127.64.219/32', '96.127.66.153/32', '96.127.68.238/32', '96.127.71.66/32', '96.127.71.69/32', '96.127.78.134/32', '96.127.84.95/32', '96.127.87.59/32', '96.127.88.165/32')

New-NetFirewallRule -DisplayName 'Zscaler ZPA' -Direction Outbound -InterfaceType Any -Action Allow -Protocol TCP -RemotePort 443 -RemoteAddress $RemoteIP


# foreach ($remoteIP in $IPAddresses) {
#     New-NetFirewallRule -Name "Zscaler ZPA" -Direction Outbound -InterfaceType Any -Action Allow -Protocol TCP -RemotePort 443 -RemoteAddress $remoteIP
# }
